(this["webpackJsonpreact-template"]=this["webpackJsonpreact-template"]||[]).push([[0],{118:function(e,t,a){e.exports=a.p+"static/media/vue.e1ea82cb.png"},145:function(e,t,a){e.exports=a(259)},150:function(e,t,a){},151:function(e,t,a){},172:function(e,t,a){},239:function(e,t,a){},246:function(e,t,a){},247:function(e,t,a){},248:function(e,t,a){},249:function(e,t,a){},258:function(e,t,a){},259:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),o=a(5),l=a.n(o),r=(a(150),a(14)),i=a(15),s=a(17),u=a(16),m=a(18),p=(a(151),a(6)),h=a.n(p),d=a(118),g=a.n(d),f=a(3),E=a(34),v=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).state={userInfo:null,token:"",messageCount:0},a.getMessageCount=function(){var e=localStorage.getItem("token");h.a.get("https://www.vue-js.com/api/v1/message/count?accesstoken=".concat(e)).then((function(e){a.setState({messageCount:e.data.data})}))},a.login=function(){var e=a.state.token;e.trim()&&h.a.post("https://www.vue-js.com/api/v1/accesstoken",{accesstoken:e}).then((function(t){localStorage.setItem("token",e),localStorage.setItem("author_id",t.data.id),delete t.data.success,a.setState({userInfo:t.data}),a.props.history.push("/")})).catch((function(){alert("\u767b\u5f55\u5931\u8d25")}))},a.logout=function(){a.setState({userInfo:null}),localStorage.clear(),a.props.history.push("/")},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=localStorage.getItem("token");t&&h.a.post("https://www.vue-js.com/api/v1/accesstoken",{accesstoken:t}).then((function(a){localStorage.setItem("token",t),localStorage.setItem("author_id",a.data.id),delete a.data.success,e.setState({userInfo:a.data})})).catch((function(){alert("\u767b\u5f55\u5931\u8d25")})),this.getMessageCount()}},{key:"componentDidUpdate",value:function(e){var t=localStorage.getItem("token");this.props.location.pathname!==e.location.pathname&&"/my/messages"!==this.props.location.pathname&&t&&this.getMessageCount()}},{key:"render",value:function(){var e=this,t=this.state,a=t.userInfo,n=t.token,o=t.messageCount;return c.a.createElement("header",null,c.a.createElement("div",{className:"header-inner"},c.a.createElement(f.b,{to:"/"},c.a.createElement("img",{style:{marginTop:"10px"},src:g.a,alt:""})),a?c.a.createElement("div",null,c.a.createElement("img",{src:a.avatar_url,alt:""}),c.a.createElement("span",{style:{color:"#fff",marginLeft:"10px",marginRight:"10px"}},a.loginname),c.a.createElement("button",{onClick:this.logout},"\u767b\u51fa"),c.a.createElement("span",null,o||"",c.a.createElement(f.b,{style:{color:"#fff",width:"100px",fontSize:"18px",marginTop:"15px"},to:"/my/messages"},"\u672a\u8bfb\u6d88\u606f")," "),"/topic/create"===this.props.location.pathname?"":c.a.createElement("button",{className:"fbht"},c.a.createElement(f.b,{to:"/topic/create"},"\u53d1\u5e03\u8bdd\u9898"))):c.a.createElement("div",{style:{marginTop:"10px"}},c.a.createElement("input",{onChange:function(t){return e.setState({token:t.target.value})},value:n,type:"text"}),c.a.createElement("button",{onClick:this.login},"\u767b\u5f55"))))}}]),t}(n.Component),b=Object(E.f)(v),y=a(260),x=a(261),k=(a(172),function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).state={topics:[],currentPage:1},a.getTopics=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;h.a.get("https://www.vue-js.com/api/v1/topics?tab=".concat(e,"&limit=").concat(n,"&page=").concat(t)).then((function(e){a.setState({topics:e.data.data})}))},a.changePage=function(e){var t=a.fromLocationGetType();a.props.history.push("?tab=".concat(t,"&page=").concat(e)),a.setState({currentPage:e})},a.fromLocationGetType=function(){var e=a.props.location.search;return""===e||e.includes("all")?"all":e.includes("share")?"share":e.includes("weex")?"weex":e.includes("good")?"good":e.includes("job")?"job":"ask"},a.fromLocationGetPage=function(){var e=a.props.location.search;return e.includes("page")?Number(e.match(/[0-9]{1,2}/)[0]):1},a.getButtonText=function(e){return e.top?"\u7f6e\u9876":"\u7cbe\u534e"},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this.fromLocationGetType(),t=this.fromLocationGetPage();this.setState({currentPage:t}),this.getTopics(e,t)}},{key:"componentDidUpdate",value:function(e){var t=this.props.location.search;if(t!==e.location.search){var a=this.fromLocationGetType();t.includes("page")?this.getTopics(a,this.fromLocationGetPage()):(this.setState({currentPage:1}),this.getTopics(a,1))}}},{key:"render",value:function(){var e=this,t=this.props.location.search,a=this.state,n=a.topics,o=a.currentPage,l=[{tab:"all",allNumber:1015},{tab:"good",allNumber:15},{tab:"share",allNumber:350},{tab:"weex",allNumber:3},{tab:"job",allNumber:39},{tab:"ask",allNumber:623}].find((function(e){return""===t?"all"===e.tab:t.indexOf(e.tab)>-1})).allNumber;return c.a.createElement("div",{className:"home"},c.a.createElement("div",{className:"nav"},c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement(f.c,{isActive:function(){return t.includes("all")||""===t},to:"/?tab=all"},"\u5168\u90e8")),c.a.createElement("li",null,c.a.createElement(f.c,{isActive:function(){return t.includes("good")},to:"/?tab=good"},"\u7cbe\u534e")),c.a.createElement("li",null,c.a.createElement(f.c,{isActive:function(){return t.includes("weex")},to:"/?tab=weex"},"weex")),c.a.createElement("li",null,c.a.createElement(f.c,{isActive:function(){return t.includes("share")},to:"/?tab=share"},"\u5206\u4eab")),c.a.createElement("li",null,c.a.createElement(f.c,{isActive:function(){return t.includes("ask")},to:"/?tab=ask"},"\u95ee\u7b54")),c.a.createElement("li",null,c.a.createElement(f.c,{isActive:function(){return t.includes("job")},to:"/?tab=job"},"\u62db\u8058")))),c.a.createElement("div",{className:"topic-list"},n.length?c.a.createElement("div",null,c.a.createElement("ul",null,n.map((function(t){return c.a.createElement("li",{key:t.id}," ",c.a.createElement(f.b,{to:"/user/".concat(t.author.loginname)},c.a.createElement("img",{src:t.author.avatar_url,alt:""}),c.a.createElement("span",{style:{color:"#9e78c0",fontSize:"14px"}},t.reply_count),"/",c.a.createElement("span",{style:{color:"#b4b4b4",fontSize:"12px"}},t.visit_count))," ",c.a.createElement("span",{className:"zd"},e.getButtonText(t)),c.a.createElement(f.b,{to:"/topic/".concat(t.id)},t.title))}))),c.a.createElement(y.a,{onChange:this.changePage,current:o,total:l,defaultPageSize:20})):c.a.createElement(x.a,null)))}}]),t}(n.Component)),w=a(94),j=(a(239),a(262)),S=a(265),C=a(266),T=a(134),O=a.n(T),I=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).state={topic:null,comment:"",textareaComment:""},a.setComment=function(e){a.setState({comment:e})},a.up=function(e){var t=localStorage.getItem("token");t?h.a.post("https://www.vue-js.com/api/v1/reply/".concat(e,"/ups"),{accesstoken:t}).then((function(t){var n=localStorage.getItem("author_id"),c=Object(w.a)({},a.state.topic),o=c.replies.find((function(t){return t.id===e}));"up"===t.data.action?o.ups.push(n):o.ups=o.ups.filter((function(e){return e!==n})),a.setState({topic:c})})):j.a.info("\u8bf7\u767b\u5f55")},a.addComment=function(){var e=a.state,t=e.topic,n=e.comment;if(n.trim()){var c=localStorage.getItem("token"),o=t.id;h.a.post("https://www.vue-js.com/api/v1/topic/".concat(o,"/replies"),{accesstoken:c,content:n}).then((function(e){var t=a.props.match.params.topicid;a.setState({comment:""}),a.myEditor.txt.html(""),h.a.get("https://www.vue-js.com/api/v1/topic/".concat(t)).then((function(e){a.setState({topic:e.data.data})}))}))}else j.a.info("\u8bf7\u8f93\u5165")},a.textareaChange=function(e){a.setState({comment:e.target.value})},a.reply=function(e){var t=e.id,n=e.author,c=a.state.topic,o=Object(w.a)({},c);o.replies.forEach((function(e){e.id===t?e.showTextarea=!e.showTextarea:e.showTextarea=!1})),a.setState({topic:o,textareaComment:"@".concat(n.loginname," ")})},a.replyReply=function(e){var t=a.state,n=t.textareaComment,c=t.topic.id;if(n.trim()){var o=localStorage.getItem("token");h.a.post("https://www.vue-js.com/api/v1/topic/".concat(c,"/replies"),{accesstoken:o,content:n,reply_id:e}).then((function(e){h.a.get("https://www.vue-js.com/api/v1/topic/".concat(c)).then((function(e){e.data.data.replies.forEach((function(e){e.showTextarea=!1})),a.setState({topic:e.data.data,textareaComment:""})}))}))}},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.topicid,a=localStorage.getItem("token");h.a.get("https://www.vue-js.com/api/v1/topic/".concat(t)).then((function(t){var n=t.data.data;n.replies.forEach((function(e){e.showTextarea=!1})),e.setState({topic:n}),a&&(e.myEditor=new O.a(e.editor),e.myEditor.customConfig.onchange=function(t){e.setComment(t)},e.myEditor.create())}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.topic,n=t.textareaComment,o=localStorage.getItem("token"),l=localStorage.getItem("author_id");return a?c.a.createElement("div",{className:"topic"},c.a.createElement("div",{className:"topic-header"},c.a.createElement("div",{className:"header-top"},c.a.createElement("span",{className:"topic-zd"},"\u7f6e\u9876"),c.a.createElement("h2",{className:"topic-h2"},a.title),c.a.createElement("br",null)),c.a.createElement("div",null,c.a.createElement("span",{className:"fa"},"\xb7 \u53d1\u5e03\u4e8e ",a.create_at),c.a.createElement("span",{className:"fa"},"\xb7 \u4f5c\u8005 ",c.a.createElement(f.b,{to:"/user/".concat(a.author.loginname)},a.author.loginname))),c.a.createElement("div",{className:"topic-content",dangerouslySetInnerHTML:{__html:a.content}})),c.a.createElement("div",{className:"comment-box"},c.a.createElement("ul",null,a.replies.map((function(t){return c.a.createElement("li",{id:t.id,key:t.id},c.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},c.a.createElement("div",null,c.a.createElement(f.b,{to:"/user/".concat(t.author.loginname)},c.a.createElement("img",{style:{width:"40px",height:"40px"},src:t.author.avatar_url,alt:""})),c.a.createElement("div",{style:{float:"left"}},c.a.createElement(f.b,{to:"/user/".concat(t.author.loginname)},c.a.createElement("span",null,t.author.loginname)),c.a.createElement("div",{dangerouslySetInnerHTML:{__html:t.content}}))),c.a.createElement("div",null,c.a.createElement("button",{onClick:function(){return e.up(t.id)},style:{color:t.ups.includes(l)?"red":"#000"}},c.a.createElement(S.a,null)),c.a.createElement("span",{style:{marginRight:"15px"}},t.ups.length),o?c.a.createElement("button",{onClick:function(){return e.reply(t)}},c.a.createElement(C.a,null)," ",c.a.createElement("label",{htmlFor:t.id})):"")),t.showTextarea?c.a.createElement("div",null," ",c.a.createElement("textarea",{id:t.id,onChange:function(t){return e.setState({textareaComment:t.target.value})},value:n}),c.a.createElement("button",{onClick:function(){return e.replyReply(t.id)}},"\u56de\u590d")):"")}))),o?c.a.createElement("div",null,c.a.createElement("h3",{style:{backgroundColor:"#f6f6f6",padding:"10px"}},"\u6dfb\u52a0\u56de\u590d"),c.a.createElement("div",{ref:function(t){return e.editor=t},id:"editor"}),c.a.createElement("button",{onClick:this.addComment},"\u56de\u590d")):"")):c.a.createElement(x.a,null)}}]),t}(n.Component),N=a(267),_=(a(246),a(247),function(e){return c.a.createElement("div",{className:"box"},c.a.createElement("div",{className:"box-header"},e.linkText?c.a.createElement("span",null," ",c.a.createElement(f.b,{style:{marginRight:"5px",marginLeft:"5px",color:"#369214",fontSize:"14px"},to:e.linkAddress},e.linkText),c.a.createElement("span",null,"/")," ",e.title1," "):"",c.a.createElement("span",{style:{marginRight:"5px",marginLeft:"5px",fontSize:"14px"}},e.title)),c.a.createElement("div",{className:"box-content"},e.children))}),A=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).state={userInfo:""},a.getInfo=function(e){h.a.get("https://www.vue-js.com/api/v1/user/".concat(e)).then((function(e){a.setState({userInfo:e.data.data})}))},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.match.params.username;this.getInfo(e)}},{key:"componentDidUpdate",value:function(e){if(this.props.location.pathname!==e.location.pathname){var t=this.props.match.params.username;this.getInfo(t)}}},{key:"render",value:function(){var e=this.state.userInfo;return c.a.createElement(_,{linkText:"\u4e3b\u9875",linkAddress:"/"},c.a.createElement("div",{className:"user"},e?c.a.createElement("div",null,c.a.createElement("div",{className:"zhuye",style:{display:"flex",flexDirection:"column"}},c.a.createElement("img",{style:{width:"40px",float:"left"},src:e.avatar_url,alt:""}),c.a.createElement("span",{style:{display:"block",float:"left"}},e.loginname),c.a.createElement("span",{style:{color:"#333",fontSize:"14px",marginTop:"10px"}},"\u79ef\u5206",e.score),e.githubUsername?c.a.createElement("span",{style:{color:"#778087",fontSize:"14px",marginTop:"10px"}},c.a.createElement(N.a,null)," ",e.githubUsername):"",e.collect_topics.length?c.a.createElement("span",null,e.collect_topics.length," \u8bdd\u9898\u6536\u85cf"):"",c.a.createElement("span",{style:{color:"#ababab",fontSize:"14px",marginTop:"10px"}},"\u521b\u5efa\u4e8e",e.create_at)),c.a.createElement("div",{className:"chuang"},c.a.createElement("h4",null,"\u6700\u8fd1\u521b\u5efa\u7684\u8bdd\u9898"),e.recent_topics.length?c.a.createElement("ul",null,e.recent_topics.map((function(e){return c.a.createElement("li",{key:e.id}," ",c.a.createElement(f.b,{to:"/user/".concat(e.author.loginname)},c.a.createElement("img",{src:e.author.avatar_url,alt:""}))," ",c.a.createElement(f.b,{to:"/topic/".concat(e.id)},e.title))}))):"\u65e0\u8bdd\u9898"),c.a.createElement("div",{className:"chuang"},c.a.createElement("h4",null,"\u6700\u8fd1\u53c2\u4e0e\u7684\u8bdd\u9898"),e.recent_replies.length?c.a.createElement("ul",null,e.recent_replies.map((function(e){return c.a.createElement("li",{key:e.id}," ",c.a.createElement(f.b,{to:"/user/".concat(e.author.loginname)},c.a.createElement("img",{src:e.author.avatar_url,alt:""}))," ",c.a.createElement(f.b,{to:"/topic/".concat(e.id)},e.title))}))):"\u65e0\u8bdd\u9898")):c.a.createElement(x.a,null)))}}]),t}(n.Component),z=(a(248),function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).state={messageInfo:null},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=localStorage.getItem("token");h.a.get("https://www.vue-js.com/api/v1/messages?accesstoken=".concat(t)).then((function(a){e.setState({messageInfo:a.data.data}),a.data.data.hasnot_read_messages.length>0&&h.a.post("https://www.vue-js.com/api/v1/message/mark_all",{accesstoken:t}).then((function(e){}))}))}},{key:"render",value:function(){var e=this.state.messageInfo;return c.a.createElement(_,{title:"\u65b0\u6d88\u606f",linkText:"\u4e3b\u9875",linkAddress:"/"},e?c.a.createElement("div",{className:"message"},c.a.createElement("div",null),c.a.createElement("div",null,c.a.createElement("h4",null,"\u8fc7\u5f80\u6d88\u606f"),c.a.createElement("ul",null,e.has_read_messages.map((function(e){return c.a.createElement("li",{key:e.id},c.a.createElement(f.b,{to:"user/".concat(e.author.loginname)},e.author.loginname),"\u5728\u8bdd\u9898",c.a.createElement(f.b,{to:"/topic/".concat(e.topic.id,"#").concat(e.reply.id)},e.topic.title),"\u4e2d ","at"===e.type?"@":"\u56de\u590d","\u4e86\u4f60")}))))):c.a.createElement(x.a,null))}}]),t}(n.Component)),L=a(66),M=a(264),P=(a(249),function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={tab:"",title:"",content:""},a.selectChange=function(e,t){a.setState(Object(L.a)({},t,e.target.value))},a.submit=function(){var e=a.state,t=e.tab,n=e.title,o=e.content,l=localStorage.getItem("token");if(!(t&&n.length>=10&&o))return c.a.createElement(M.a,{message:"Warning Text Warning Text Warning TextW arning Text Warning Text Warning TextWarning Text",type:"warning",closable:!0,onClose:function(){}});h.a.post("https://www.vue-js.com/api/v1/topics",{tab:t,title:n,content:o,accesstoken:l}).then((function(e){a.props.history.push("/topic/".concat(e.data.topic_id))}))},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.tab,n=t.title,o=t.content;return c.a.createElement(_,{title:"\u53d1\u5e03\u8bdd\u9898",linkText:"\u4e3b\u9875",linkAddress:"/"},c.a.createElement("div",{className:"create-topic"},c.a.createElement("span",null,"\u9009\u62e9\u677f\u5757:"),c.a.createElement("select",{value:a,onChange:function(t){return e.selectChange(t,"tab")}},c.a.createElement("option",{value:""},"\u8bf7\u9009\u62e9"),c.a.createElement("option",{value:"share"},"\u5206\u4eab"),c.a.createElement("option",{value:"ask"},"\u95ee\u7b54"),c.a.createElement("option",{value:"job"},"\u62db\u8058")),"job"===a?c.a.createElement("span",null,"\u4e3a\u907f\u514d\u88ab\u7ba1\u7406\u5458\u5220\u5e16\uff0c\u53d1\u5e16\u65f6\u8bf7\u597d\u597d\u9605\u8bfb ",c.a.createElement(f.b,{to:"/topic/541ed2d05e28155f24676a12"},"\u300a\u62db\u8058\u5e16\u89c4\u8303\u300b")):"",c.a.createElement("br",null),c.a.createElement("input",{onChange:function(t){return e.selectChange(t,"title")},value:n,type:"text",placeholder:"\u6807\u9898\u5b57\u6570 10 \u5b57\u4ee5\u4e0a"}),c.a.createElement("br",null),c.a.createElement("textarea",{value:o,onChange:function(t){return e.selectChange(t,"content")}}),c.a.createElement("button",{onClick:this.submit},"\u63d0\u4ea4")))}}]),t}(n.Component)),D=(a(258),function(e){return c.a.createElement(E.c,null,c.a.createElement(E.a,{exact:!0,path:"/",component:k}),c.a.createElement(E.a,{path:"/topic/create",component:P}),c.a.createElement(E.a,{path:"/topic/:topicid",component:I}),c.a.createElement(E.a,{path:"/user/:username",component:A}),c.a.createElement(E.a,{path:"/my/:Messages",component:z}))});var W=function(){return c.a.createElement("div",{className:"App"},c.a.createElement(f.a,null,c.a.createElement(b,null),c.a.createElement(D,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(c.a.createElement(W,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[145,1,2]]]);
//# sourceMappingURL=main.8e87f350.chunk.js.map